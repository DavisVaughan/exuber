<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulation of a two-bubble process — sim_psy2 • exuber</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Simulation of a two-bubble process — sim_psy2" />
<meta property="og:description" content="The following data generating process is similar to  sim_psy1, with the difference that
there are two episodes of mildly explosive dynamics." />
<meta property="og:image" content="https://kvasilopoulos.github.io/exuber/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exuber</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/exuber.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/simulation.html">Simulation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/kvasilopoulos/exuber">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of a two-bubble process</h1>
    <small class="dont-index">Source: <a href='https://github.com/kvasilopoulos/exuber/blob/master/R/simul.R'><code>R/simul.R</code></a></small>
    <div class="hidden name"><code>sim_psy2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The following data generating process is similar to  <code><a href='sim_psy1.html'>sim_psy1</a></code>, with the difference that
there are two episodes of mildly explosive dynamics.</p>
    </div>

    <pre class="usage"><span class='fu'>sim_psy2</span>(
  <span class='no'>n</span>,
  <span class='kw'>te1</span> <span class='kw'>=</span> <span class='fl'>0.2</span> * <span class='no'>n</span>,
  <span class='kw'>tf1</span> <span class='kw'>=</span> <span class='fl'>0.2</span> * <span class='no'>n</span> + <span class='no'>te1</span>,
  <span class='kw'>te2</span> <span class='kw'>=</span> <span class='fl'>0.6</span> * <span class='no'>n</span>,
  <span class='kw'>tf2</span> <span class='kw'>=</span> <span class='fl'>0.1</span> * <span class='no'>n</span> + <span class='no'>te2</span>,
  <span class='kw'>c</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.6</span>,
  <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>6.79</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>A strictly positive integer specifying the length of the simulated output series.</p></td>
    </tr>
    <tr>
      <th>te1</th>
      <td><p>A scalar in (0, n) specifying the observation in which the first bubble originates.</p></td>
    </tr>
    <tr>
      <th>tf1</th>
      <td><p>A scalar in  (te1, n) specifying the observation in which the first bubble collapses.</p></td>
    </tr>
    <tr>
      <th>te2</th>
      <td><p>A scalar in (tf1, n) specifying the observation in which the second bubble originates.</p></td>
    </tr>
    <tr>
      <th>tf2</th>
      <td><p>A scalar in (te2, n) specifying the observation in which the second bubble collapses.</p></td>
    </tr>
    <tr>
      <th>c</th>
      <td><p>A positive scalar determining the autoregressive coefficient in the explosive regime.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A positive scalar in (0, 1) determining the value of the expansion rate in the autoregressive coefficient.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>A positive scalar indicating the standard deviation of the innovations.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>An object specifying if and how the random number generator(rng)
should be initialized. Either NULL or an integer will be used in a call to
<code>set.seed</code> before simulation. If set, the value is save as "seed" attribute
of the returned value. The default, NULL will note change the rng state, and
return .Random.seed as the "seed" attribute. Results between seeds in parallell
and non-parallel differ.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of length <code>n</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The data generating process is described by:</p>
<p>$$X_t = X_{t-1}1\{t \in N_0\}+ \delta_T X_{t-1}1\{t \in B_1 \cup B_2\} +
\left(\sum_{k=\tau_{1f}+1}^t \epsilon_k + X^*_{\tau_{1f}}\right) 1\{t \in N_1\} $$</p>
<p>$$ + \left(\sum_{l=\tau_{2f}+1}^t \epsilon_l + X^*_{\tau_{2f}}\right) 1\{t \in N_2\} +
\epsilon_t 1\{t \in N_0 \cup B_1 \cup B_2\}$$</p>
<p>where the autoregressive coefficient \(\delta_T\) is given:</p>
<p>$$\delta_T = 1 + cT^{-a}$$</p>
<p>with \(c&gt;0\), \(\alpha \in (0,1)\),
\(\epsilon \sim iid(0, \sigma^2)\),
\(X_{\tau_{1f}} = X_{\tau_{1e}} + X^*\) and
\(X_{\tau_{2f}} = X_{\tau_{2e}} + X^*\).
We use the notation
\(N_0 = [1, \tau_{1e})\),
\(B_1 = [\tau_{1e}, \tau_{1f}]\),
\(N_1 = (\tau_{1f}, \tau_{2e})\),
\(B_2 = [\tau_{2e}, \tau_{2f}]\),
\(N_2 = (\tau_{2f}, \tau]\), where \(\tau\) is the last observation of the sample.
After the collapse of the first bubble, \(X_t\) resumes a martingale path until time
\(\tau_{2e}-1\), and a second episode of exuberance begins at \(\tau_{2e}\).
The expansion process lasts until \(\tau_{2f}\) and collapses to a value of
\(X^*_{\tau_{2f}}\). The process then continues on a martingale path until the end of the
sample period \(\tau\). The expansion duration of the first bubble is assumed to be longer than
that of the second bubble, i.e. \(\tau_{1f}-\tau_{1e}&gt;\tau_{2f}-\tau_{2e}\).</p>
<p>For further details the user can refer to Phillips et al., (2015) p. 1055.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Phillips, P. C. B., Shi, S., &amp; Yu, J. (2015). Testing for Multiple Bubbles:
Historical Episodes of Exuberance and Collapse in the S&amp;P 500. International Economic Review, 5
6(4), 1043-1078.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sim_psy1.html'>sim_psy1</a></code>, <code><a href='sim_blan.html'>sim_blan</a></code>, <code><a href='sim_evans.html'>sim_evans</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># 100 periods with bubble origination dates 20/60 and termination dates 40/70 respectively</span>
<span class='fu'>sim_psy2</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt;   [1] 100.00000  96.41738  99.67369 109.29872 108.75490 106.07837 109.64487
#&gt;   [8] 104.24047 105.90468 100.61309 104.65263 112.18200 105.77924 110.53457
#&gt;  [15] 107.65103  99.88913 101.47419 100.18927  88.89471 107.51112 108.74790
#&gt;  [22] 118.21442 122.55913 125.43246 136.26335 136.91768 154.53359 173.55890
#&gt;  [29] 182.81410 191.46503 211.00406 228.87308 243.52418 274.97171 309.87876
#&gt;  [36] 337.66217 350.47159 375.30266 405.32932 427.69444 118.25978 122.31853
#&gt;  [43] 125.48325 120.42899 126.94098 127.97738 122.75337 132.21239 138.45015
#&gt;  [50] 145.34938 148.97956 142.27356 150.33867 146.82456 145.06214 142.83458
#&gt;  [57] 143.33319 141.65020 132.32167 140.39598 152.11661 163.08337 161.84930
#&gt;  [64] 176.42243 180.79626 198.74803 200.04369 219.93674 233.07352 260.67494
#&gt;  [71] 132.67554 130.77624 124.70511 125.63331 120.54648 124.06505 122.75908
#&gt;  [78] 122.95470 125.38953 125.19266 132.98107 135.51774 137.71321 132.07874
#&gt;  [85] 141.54714 140.24656 142.09532 134.75086 118.93424 115.20228 114.70946
#&gt;  [92] 121.71870 123.17949 119.82292 130.09034 126.15578 137.52760 130.73095
#&gt;  [99] 139.03310 146.34721</div><div class='input'>
<span class='co'># 200 periods with bubble origination dates 40/120 and termination dates 80/140 respectively</span>
<span class='fu'>sim_psy2</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>200</span>)</div><div class='output co'>#&gt;   [1] 100.00000  95.84489  99.28652 102.41038 112.48940 118.47793 114.83372
#&gt;   [8] 123.56263 127.55413 118.66953 120.82010 128.92844 135.12810 129.78604
#&gt;  [15] 126.99583 130.23041 131.49278 122.49795 130.45835 132.03019 135.31025
#&gt;  [22] 131.67543 141.03297 132.18783 136.49851 143.28617 140.99286 140.40869
#&gt;  [29] 128.73792 122.42918 127.95404 131.52839 138.39958 144.04465 146.86341
#&gt;  [36] 142.37347 146.09990 142.43759 141.27434 141.94914 143.73950 160.90830
#&gt;  [43] 173.31739 182.82840 187.68996 201.61412 218.09147 226.84731 241.63366
#&gt;  [50] 259.61409 268.57553 277.62565 287.23858 293.74029 305.32598 317.53321
#&gt;  [57] 335.60277 350.41996 373.81100 381.80447 391.98052 398.08359 412.72634
#&gt;  [64] 430.19826 448.04620 446.67304 465.40522 484.11050 508.26294 526.52988
#&gt;  [71] 552.75742 571.83923 594.49531 606.21117 621.02866 639.31140 676.77358
#&gt;  [78] 700.60180 740.40404 761.38557 136.57482 133.14940 135.87780 142.47358
#&gt;  [85] 138.53767 149.43005 150.96441 147.46853 141.87501 144.14569 143.51089
#&gt;  [92] 145.57547 142.33998 140.70148 146.29749 135.73467 136.36955 133.87796
#&gt;  [99] 132.99927 135.76820 131.80306 130.48953 128.65931 129.15945 131.58508
#&gt; [106] 135.32249 135.58324 124.65422 117.52669 131.46000 132.65800 140.31921
#&gt; [113] 143.27287 146.99945 151.39542 157.36019 159.74211 160.08079 165.75553
#&gt; [120] 170.74263 172.47474 179.66569 179.08142 188.99698 193.13382 205.87865
#&gt; [127] 214.03577 214.84144 222.97061 227.44430 225.93512 238.70708 257.46921
#&gt; [134] 257.21451 259.43175 280.97396 301.17492 312.29033 320.95121 337.02021
#&gt; [141] 179.85463 179.59928 183.29080 195.10688 192.90382 189.86522 192.69042
#&gt; [148] 183.89150 188.52657 191.90062 201.67591 209.87388 211.49339 209.46428
#&gt; [155] 218.86586 214.11239 226.74812 238.99677 229.78923 227.65207 220.73126
#&gt; [162] 216.57409 214.61131 224.84372 227.34056 227.20452 220.55085 211.03866
#&gt; [169] 220.85031 217.97487 212.99271 208.18210 218.19798 223.93556 232.72178
#&gt; [176] 234.74629 231.99171 231.04920 229.53780 241.40095 240.84618 241.68910
#&gt; [183] 244.35238 246.92185 248.05018 255.88168 255.98183 256.12741 250.51648
#&gt; [190] 250.83832 248.84812 257.04794 257.26523 258.49013 259.01405 262.80555
#&gt; [197] 261.67261 260.12463 261.77233 255.46793</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://kvasilopoulos.com/'>Kostas Vasilopoulos</a>, <a href='https://sites.google.com/site/etpavlidis/'>Efthymios Pavlidis</a>, Simon Spavound, <a href='https://sites.google.com/view/emgeconomics'>Enrique Martínez-García</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '3da85b7c10c52498fbaeb87339345e28',
    indexName: 'exuber',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>



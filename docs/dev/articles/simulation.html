<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation • exuber</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Simulation">
<meta property="og:description" content="">
<meta property="og:image" content="https://kvasilopoulos.github.io/exuber/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exuber</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/exuber.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simulation.html">Simulation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/kvasilopoulos/exuber">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kvasilopoulos/exuber/blob/master/../../r/exuber/vignettes/simulation.Rmd"><code>../../r/exuber/vignettes/simulation.Rmd</code></a></small>
      <div class="hidden name"><code>simulation.Rmd</code></div>

    </div>

    
    
<p>The exuber package has numerous functions which allow the creation of time series which incorporate rational bubble models. These include <code><a href="../reference/sim_dgp1.html">sim_dgp1()</a></code>, which generates a time series with a single episode of explosive behavior, <code><a href="../reference/sim_dgp2.html">sim_dgp2()</a></code> which generates a time series with two episodes of explosive behavior. Two rational bubble models are also currently included; <code><a href="../reference/sim_blan.html">sim_blan()</a></code> which generates a time series containing rational bubbles as proposed by Blanchard (1979). The final function, <code><a href="../reference/sim_evans.html">sim_evans()</a></code> generates a periodically collapsing rational bubble model series. It is the latter type of bubbles that the GSADF test that PSY attempts to detect.</p>
<p>To test the GSADF test and its associated date-stamping strategy, the BSADF test, PSY utilize a model of dividends and incorporate an Evans (1991) type bubble. We replicate that here to show 1) the ability of exuber to generate realistic simulated time series which incorporate bubbles and 2) to demonstrate the capabilities of <code><a href="../reference/radf.html">radf()</a></code> to detect them.</p>
<p>Let’s start be generating a realistic prices series incorporating an Evans (1991) type periodically collapsing bubble. We will use the monthly parameterisation detailed in PSY (2015a), which corresponds to the empirical values from the S&amp;P 500 (see later example). exuber contains a function <code><a href="../reference/sim_div.html">sim_div()</a></code> which can be used to generate simulated dividends streams from a random walk with drift model.</p>
<p>Need to make all of these clearer and more consistent with either Evans or Phillips (i.e., need to make a decision)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">125</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># The fundamental value from the Lucas pricing model</span></a>
<a class="sourceLine" id="cb1-3" title="3">pf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_div.html">sim_div</a></span>(<span class="dv">400</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># The Evans bubble term</span></a>
<a class="sourceLine" id="cb1-6" title="6">pb &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_evans.html">sim_evans</a></span>(<span class="dv">400</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># the scaling factor for the bubble</span></a>
<a class="sourceLine" id="cb1-9" title="9">kappa &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># The simulated price</span></a>
<a class="sourceLine" id="cb1-12" title="12">p &lt;-<span class="st"> </span>pf <span class="op">+</span><span class="st"> </span>kappa<span class="op">*</span>pb</a></code></pre></div>
<p>We can now plot this data to see what it looks like:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">NROW</a></span>(p),</a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="st">"Price"</span> =<span class="st"> </span>p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> index, <span class="dt">y =</span> Price)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">""</span>, <span class="dt">x =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="simulation_files/figure-html/plot%20simulation-1.png" width="864"></p>
<p>As we can see it looks very typical for the kind of data we wish to analyze with some peaks and troughs which may be indicative of explosive sub-periods. Let us conduct a more formal analysis:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/radf.html">radf</a></span>(p)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="../reference/summary.html">summary</a></span>(test)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt;  Recursive Unit Root</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt;  ----------------------------------</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt;  H0: Unit root</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;  H1: Explosive root</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;  ----------------------------------</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;  Critical values: Monte Carlo </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;  Minimum window: 40 </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;  Iterations: 2000 </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;  Lag: 0 </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;  ----------------------------------</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  Series 1 </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;         tstat      90%       95%     99%</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; ADF    -4.470  -0.4612  -0.04892  0.6713</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; SADF    2.774   1.1406   1.44256  1.9275</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; GSADF   4.137   1.9094   2.17291  2.6400</span></a></code></pre></div>
<div id="simulated-and-mc" class="section level1">
<h1 class="hasAnchor">
<a href="#simulated-and-mc" class="anchor"></a>Simulated and MC</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulated-and-mc">Simulated and MC</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://kvasilopoulos.netlify.com/">Kostas Vasilopoulos</a>, Efthymios Pavlidis, Simon Spavound, Enríque Martínez-García.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '3da85b7c10c52498fbaeb87339345e28',
    indexName: 'exuber',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>

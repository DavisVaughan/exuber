<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulation of a two-bubble process — sim_psy2 • exuber</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Simulation of a two-bubble process — sim_psy2" />
<meta property="og:description" content="The following data generating process is similar to  sim_psy1, with the difference that
there are two episodes of mildly explosive dynamics." />
<meta property="og:image" content="https://kvasilopoulos.github.io/exuber/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">exuber</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/exuber.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/simulation.html">Simulation</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/tidy.html">Available tidy methods</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/kvasilopoulos/exuber">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of a two-bubble process</h1>
    <small class="dont-index">Source: <a href='https://github.com/kvasilopoulos/exuber/blob/master/R/simul.R'><code>R/simul.R</code></a></small>
    <div class="hidden name"><code>sim_psy2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The following data generating process is similar to  <code><a href='sim_psy1.html'>sim_psy1</a></code>, with the difference that
there are two episodes of mildly explosive dynamics.</p>
    </div>

    <pre class="usage"><span class='fu'>sim_psy2</span>(
  <span class='no'>n</span>,
  <span class='kw'>te1</span> <span class='kw'>=</span> <span class='fl'>0.2</span> * <span class='no'>n</span>,
  <span class='kw'>tf1</span> <span class='kw'>=</span> <span class='fl'>0.2</span> * <span class='no'>n</span> + <span class='no'>te1</span>,
  <span class='kw'>te2</span> <span class='kw'>=</span> <span class='fl'>0.6</span> * <span class='no'>n</span>,
  <span class='kw'>tf2</span> <span class='kw'>=</span> <span class='fl'>0.1</span> * <span class='no'>n</span> + <span class='no'>te2</span>,
  <span class='kw'>c</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.6</span>,
  <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>6.79</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>A strictly positive integer specifying the length of the simulated output series.</p></td>
    </tr>
    <tr>
      <th>te1</th>
      <td><p>A scalar in (0, n) specifying the observation in which the first bubble originates.</p></td>
    </tr>
    <tr>
      <th>tf1</th>
      <td><p>A scalar in  (te1, n) specifying the observation in which the first bubble collapses.</p></td>
    </tr>
    <tr>
      <th>te2</th>
      <td><p>A scalar in (tf1, n) specifying the observation in which the second bubble originates.</p></td>
    </tr>
    <tr>
      <th>tf2</th>
      <td><p>A scalar in (te2, n) specifying the observation in which the second bubble collapses.</p></td>
    </tr>
    <tr>
      <th>c</th>
      <td><p>A positive scalar determining the autoregressive coefficient in the explosive regime.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A positive scalar in (0, 1) determining the value of the expansion rate in the autoregressive coefficient.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>A positive scalar indicating the standard deviation of the innovations.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>An object specifying if and how the random number generator(rng)
should be initialized. Either NULL or an integer will be used in a call to
<code>set.seed</code> before simulation. If set, the value is save as "seed" attribute
of the returned value. The default, NULL will note change the rng state, and
return .Random.seed as the "seed" attribute. Results between seeds in parallel
and non-parallel differ.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of length <code>n</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The data generating process is described by:</p>
<p>$$X_t = X_{t-1}1\{t \in N_0\}+ \delta_T X_{t-1}1\{t \in B_1 \cup B_2\} +
\left(\sum_{k=\tau_{1f}+1}^t \epsilon_k + X^*_{\tau_{1f}}\right) 1\{t \in N_1\} $$</p>
<p>$$ + \left(\sum_{l=\tau_{2f}+1}^t \epsilon_l + X^*_{\tau_{2f}}\right) 1\{t \in N_2\} +
\epsilon_t 1\{t \in N_0 \cup B_1 \cup B_2\}$$</p>
<p>where the autoregressive coefficient \(\delta_T\) is given:</p>
<p>$$\delta_T = 1 + cT^{-a}$$</p>
<p>with \(c&gt;0\), \(\alpha \in (0,1)\),
\(\epsilon \sim iid(0, \sigma^2)\),
\(X_{\tau_{1f}} = X_{\tau_{1e}} + X^*\) and
\(X_{\tau_{2f}} = X_{\tau_{2e}} + X^*\).
We use the notation
\(N_0 = [1, \tau_{1e})\),
\(B_1 = [\tau_{1e}, \tau_{1f}]\),
\(N_1 = (\tau_{1f}, \tau_{2e})\),
\(B_2 = [\tau_{2e}, \tau_{2f}]\),
\(N_2 = (\tau_{2f}, \tau]\), where \(\tau\) is the last observation of the sample.
After the collapse of the first bubble, \(X_t\) resumes a martingale path until time
\(\tau_{2e}-1\), and a second episode of exuberance begins at \(\tau_{2e}\).
The expansion process lasts until \(\tau_{2f}\) and collapses to a value of
\(X^*_{\tau_{2f}}\). The process then continues on a martingale path until the end of the
sample period \(\tau\). The expansion duration of the first bubble is assumed to be longer than
that of the second bubble, i.e. \(\tau_{1f}-\tau_{1e}&gt;\tau_{2f}-\tau_{2e}\).</p>
<p>For further details the user can refer to Phillips et al., (2015) p. 1055.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Phillips, P. C. B., Shi, S., &amp; Yu, J. (2015). Testing for Multiple Bubbles:
Historical Episodes of Exuberance and Collapse in the S&amp;P 500. International Economic Review, 5
6(4), 1043-1078.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sim_psy1.html'>sim_psy1</a></code>, <code><a href='sim_blan.html'>sim_blan</a></code>, <code><a href='sim_evans.html'>sim_evans</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># 100 periods with bubble origination dates 20/60 and termination dates 40/70 respectively</span>
<span class='fu'>sim_psy2</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt;   [1] 100.00000 102.52303 104.93642  98.25507  99.71308  99.16930  89.51141
#&gt;   [8]  97.03574 104.35861 101.36931  96.08554  83.73731  76.10480  83.30576
#&gt;  [15]  73.26539  62.73029  68.00956  75.26427  74.01771  89.26838  93.45292
#&gt;  [22] 105.66774 115.12433 113.69804 115.55964 107.39635 113.31437 130.29694
#&gt;  [29] 128.72180 146.80580 151.02161 158.48475 170.77716 177.42753 186.61560
#&gt;  [36] 197.47674 215.46907 227.21111 256.21007 279.78873  94.31597  86.11460
#&gt;  [43]  88.34049  84.71350  93.43150  93.62795  90.94130  86.22314  76.09192
#&gt;  [50]  85.89842  83.54217  83.26881  91.73345  82.59206  78.69527  73.90181
#&gt;  [57]  61.29003  59.61310  57.33464  59.25894  66.11809  67.16595  71.80398
#&gt;  [64]  71.29231  61.09989  63.37366  73.31289  71.32859  72.34757  70.64191
#&gt;  [71]  49.11179  47.98513  58.72852  65.61767  57.83309  51.65521  72.76656
#&gt;  [78]  65.50430  60.75055  59.40312  64.45230  64.11171  73.02796  73.61199
#&gt;  [85]  69.33530  73.78322  73.91491  78.64258  92.28281  91.89592  93.52834
#&gt;  [92]  93.37971  87.73852  97.26132  92.34625 101.38089  95.87194 108.06024
#&gt;  [99] 112.72243 113.32931</div><div class='input'>
<span class='co'># 200 periods with bubble origination dates 40/120 and termination dates 80/140 respectively</span>
<span class='fu'>sim_psy2</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>200</span>)</div><div class='output co'>#&gt;   [1]  100.000000  102.203679  102.687929  104.270328  117.757825  111.295980
#&gt;   [7]  107.502799  109.239779  107.894842  110.806320  111.286850  100.852970
#&gt;  [13]  103.935524  109.872690  101.061052   93.734878   86.029247   86.182798
#&gt;  [19]   86.037077   84.144212   83.979850   89.581738   84.487997   88.128866
#&gt;  [25]   77.450114   70.752272   84.220321   71.649461   65.471999   52.221722
#&gt;  [31]   46.787845   34.094879   28.998499   24.986027   19.947173   24.656120
#&gt;  [37]   24.252360   11.596512    2.942597   -9.033134  -12.862511  -25.191351
#&gt;  [43]  -25.965140  -27.889186  -33.210744  -33.502331  -39.394377  -43.307915
#&gt;  [49]  -40.880474  -35.600793  -44.786557  -40.425090  -33.865682  -39.932913
#&gt;  [55]  -49.027345  -48.590743  -57.457898  -56.081310  -55.454956  -57.047932
#&gt;  [61]  -61.145584  -70.321307  -70.571880  -66.618430  -65.104096  -71.096502
#&gt;  [67]  -84.419890  -83.745734  -78.885015  -81.099707  -74.926636  -75.351378
#&gt;  [73]  -76.271668  -89.355620  -98.502502  -99.411544 -111.359540 -117.839319
#&gt;  [79] -119.638783 -124.734210  -12.710559   -6.763786   -1.733495   -2.852571
#&gt;  [85]   -7.951619  -16.461976  -23.498020  -23.697908  -25.564776  -22.268561
#&gt;  [91]  -16.042253  -22.732738  -32.857916  -27.292884  -20.411867  -13.257887
#&gt;  [97]  -13.742888   -7.275789   -9.883404  -12.719994  -15.913115  -27.389439
#&gt; [103]  -33.809368  -36.138419  -33.704459  -33.377257  -25.703387  -29.286011
#&gt; [109]  -26.029694  -16.404670  -16.948487  -19.625016  -16.058517  -21.462916
#&gt; [115]  -19.798712  -25.090293  -21.050760  -13.521391  -19.924151  -15.998211
#&gt; [121]  -19.547721  -28.123351  -27.709001  -30.147379  -42.696906  -31.466738
#&gt; [127]  -38.323338  -37.313662  -41.981055  -48.588258  -47.694239  -57.622939
#&gt; [133]  -51.044667  -43.894638  -47.417493  -52.275230  -46.992922  -44.393560
#&gt; [139]  -46.031378  -31.865361    1.559291    9.790678    1.295052    4.012858
#&gt; [145]   10.359523    7.150095   17.898754   21.957506   25.122220   20.067964
#&gt; [151]   26.579950   27.616355   22.392342   31.851360   38.089121   44.988352
#&gt; [157]   48.618527   41.912529   49.977638   46.463527   44.701113   42.473554
#&gt; [163]   42.972160   41.289170   31.960645   31.686018   34.548262   35.917110
#&gt; [169]   24.393176   28.754310   21.996633   28.540929   17.296436   24.567583
#&gt; [175]   23.827294   36.722770   29.002331   27.103034   21.031898   21.960103
#&gt; [181]   16.873270   20.391842   19.085872   19.281491   21.716323   21.519447
#&gt; [187]   29.307862   31.844531   34.040004   28.405531   37.873932   36.573351
#&gt; [193]   38.422112   31.077648   15.261026   11.529066   11.036247   18.045486
#&gt; [199]   19.506276   16.149707</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://kvasilopoulos.com/'>Kostas Vasilopoulos</a>, <a href='https://sites.google.com/site/etpavlidis/'>Efthymios Pavlidis</a>, Simon Spavound, <a href='https://sites.google.com/view/emgeconomics'>Enrique Martínez-García</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '3da85b7c10c52498fbaeb87339345e28',
    indexName: 'exuber',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


